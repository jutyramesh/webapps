{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "nsgName": {
            "value": "wh-datalynx-nprod-int-general-eastus2-vnet-01-dataeng01-nsg"
        },
        "location": {
            "value": "eastus2"
        },
        "tags": {
            "value": {
				"LegalSubEntity": "Walgreens Health",
				"SubDivision": "Walgreens Health",
				"Department": "Walgreens Health Organic Business",
				"CostCenter": "WAG Health Admin SG&A",
				"CostCode": "1000641601"
            }
        },
        "localRules": {
            "value": []
        },
        "platformRules": {
            "value": [
                {
                    "name": "Allow_Outbound_To_AzureCloud",
                    "properties": {
                        "description": "trusting all Azure services",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "AzureCloud",
                        "access": "Allow",
                        "priority": 550,
                        "direction": "Outbound"
                    }
                }
            ]
        },
        "infraRules": {
            "value": [
                {
                    "name": "Inbound_Infra_Tcp",
                    "properties": {
                        "description": "Standard inbound TCP allowances from the infrastructure zone for core services",
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRanges": [
                            "22",
                            "53",
                            "80",
                            "135",
                            "139",
                            "443",
                            "445",
                            "953",
                            "1433",
                            "3389",
                            "5985",
                            "5986",
                            "9042",
                            "61621",
                            "7080",
                            "18080",
                            "4040-4050",
                            "8983",
                            "8980"
                        ],
                        "sourceAddressPrefixes": [
                            "10.0.1.0/24",
                            "10.0.2.0/24"
                        ],
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 2500,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "Inbound_Infra_Udp",
                    "properties": {
                        "description": "Standard inbound UDP allowances from the infrastructure zone for core services",
                        "protocol": "Udp",
                        "sourcePortRange": "*",
                        "destinationPortRanges": [
                            "53",
                            "137",
                            "138",
                            "161"
                        ],
                        "sourceAddressPrefixes": [
                            "10.0.1.0/24",
                            "10.0.2.0/24"
                        ],
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 2501,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "Outbound_Infra_Tcp",
                    "properties": {
                        "description": "Standard outbound TCP allowances to the infrastructure zone for core services",
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRanges": [
                            "25",
                            "53",
                            "80",
                            "111",
                            "443",
                            "953",
                            "1389",
                            "1636",
                            "1918",
                            "2389",
                            "5647",
                            "5670",
                            "8000",
                            "8080",
                            "8989",
                            "8140",
                            "8443",
                            "9090",
                            "10000",
                            "10002",
                            "8888",
                            "7081",
                            "18080",
                            "514",
                            "1514-1515",
                            "5601",
                            "9200-9300",
                            "88",
                            "135",
                            "389",
                            "445",
                            "464",
                            "636",
                            "3268-3269",
                            "9389",
                            "5722",
                            "49152-65535"
                        ],
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefixes": [
                            "10.0.1.0/24",
                            "10.0.2.0/24"
                        ],
                        "access": "Allow",
                        "priority": 2500,
                        "direction": "Outbound"
                    }
                },
                {
                    "name": "Outbound_Infra_Udp",
                    "properties": {
                        "description": "Standard outbound UDP allowances to the infrastructure zone for core services",
                        "protocol": "Udp",
                        "sourcePortRange": "*",
                        "destinationPortRanges": [
                            "53",
                            "67-69",
                            "123",
                            "162",
                            "1918",
                            "514",
                            "1514-1515",
                            "88",
                            "137",
                            "389",
                            "464",
                            "636"
                        ],
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefixes": [
                            "10.0.1.0/24",
                            "10.0.2.0/24"
                        ],
                        "access": "Allow",
                        "priority": 2501,
                        "direction": "Outbound"
                    }
                }
            ]
        },
        "microsoftRules": {
            "value": []
        },
        "baseRules": {
            "value": [
                {
                    "name": "VirtualDesktop_Inbound_Allow_01",
                    "properties": {
                        "description": "null",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefixes": [
                            "10.0.4.0/22",
                            "10.0.8.0/22",
                            "10.0.12.0/22"
                        ],
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 4025,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "VPN_Inbound_Allow_01",
                    "properties": {
                        "description": "null",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefixes": [
                            "192.168.0.0/24"
                        ],
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 4026,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "Deny_Internal_Inbound",
                    "properties": {
                        "description": "Deny all private inbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefixes": [
                            "10.0.0.0/8",
                            "172.16.0.0/12",
                            "192.168.0.0/16"
                        ],
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 4050,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "Deny_Internet_Inbound",
                    "properties": {
                        "description": "Deny all internet inbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "Internet",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 4051,
                        "direction": "Inbound"
                    }
                },
                {
                    "name": "Deny_Internal_Outbound",
                    "properties": {
                        "description": "Deny all private outbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefixes": [
                            "10.0.0.0/8",
                            "172.16.0.0/12",
                            "192.168.0.0/16"
                        ],
                        "access": "Deny",
                        "priority": 4052,
                        "direction": "Outbound"
                    }
                }
            ]
        }
    },
    "deploymentParameters": {
        "type": "Subnet",
        "zone": "Infrastructure",
        "resourceGroup": "dev-datalynx-dataeng-vnet01-eastus2",
        "subscription": "wh-nprod-dataengineering-01",
        "templateFile": "templates/nsg-template.json"
    }
}